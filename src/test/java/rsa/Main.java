package rsa;

import java.util.Optional;

import javax.xml.bind.DatatypeConverter;

import org.junit.Test;

import rsa.test.NumberTests;
import rsa.test.StringTests;

public class Main {
	
	@Test
	public void numberTests() throws Exception {
		
		// System.setProperty(org.slf4j.impl.SimpleLogger.DEFAULT_LOG_LEVEL_KEY, "DEBUG");
		
		NumberTests.run("907", "773", "11", "4", Optional.of("688749"));
		NumberTests.run("53", "59", "3", "89", Optional.of("1394"));
		NumberTests.run("11", "13", "7", "9", Optional.of("48"));
		NumberTests.run(
			"12131072439211271897323671531612440428472427633701410925634549312301964373042085619324197365322416866541017057361365214171711713797974299334871062829803541",
			"12027524255478748885956220793734512128733387803682075433653899983955179850988797899869146900809131611153346817050832096022160146366346391812470987105415233",
			"65537",
			"1976620216402300889624482718775150",
			Optional.of(
				"35052111338673026690212423937053328511880760811579981620642802346685810623109850235943049080973386241113784040794704193978215378499765413083646438784740952306932534945195080183861574225226218879827232453912820596886440377536082465681750074417459151485407445862511023472235560823053497791518928820272257787786"
			)
		);
		NumberTests.run("1999", "2039", "65537", "113", Optional.of("3345792"));
		NumberTests.run("1999", "2039", "65537", "947865", Optional.of("2621940"));
		
	}
	
	@Test
	public void stringTests() throws Exception {
		
		StringTests.run("1999", "2039", "65537", "ABC", Optional.of(DatatypeConverter.parseHexBinary("2CA917041E0C")));
		
		StringTests.run(
			"8585601003304617751740320827453694699460352940985499285846356051433933707272777415224443132526485572404591427395745147999957290323583022588169390199334493",
			"12985327516965958665360399473862721463399836144006453798801529921381199801467862658438062082102034327863184636586996361032755647822250053403036782460452567",
			"17",
			"ABC",
			Optional.empty()
		);
		
		StringTests.run(512, "ABC");
		
		StringTests.run(2048, "ABC ABC ABC ZZZZ");
		
	}
	
}
